(function(s,O,j,J,K,P,q,g,f,o,p,W,v,r,X){"use strict";const L=d=>typeof d.id=="function"?d.id():d.id,n=(d,t)=>typeof d[t]=="function"?d[t]():d.attributes?d.attributes[t]:d[t],_=d=>String(L(d)),Y=(d,t)=>{const e=String(t);return d.find(a=>{const i=L(a);return String(i)===e})},I=(d,t)=>{const e=n(d,t);return e?new Date(e):new Date},V={pending:"warning",approved:"success",rejected:"danger"},y={MIN_AMOUNT:.001,MAX_AMOUNT:10,FEE:5e-4,BALANCE_PRECISION:8},D={COINS:"fas fa-coins",CHEVRON_DOWN:"fas fa-chevron-down",PASTE:"fas fa-paste",BOOKMARK:"fas fa-bookmark"};class U{view(t){const{platform:e,className:a="",size:i="medium"}=t.attrs;if(!e)return f(D.COINS,{className:`crypto-icon default ${a}`});const l=n(e,"iconUrl"),c=n(e,"iconClass"),h=n(e,"name"),u=n(e,"symbol"),w=`platform-icon-${i}`;if(l)return m("img",{src:l,alt:h||"Platform",className:`platform-icon-image ${w} ${a}`,onerror:R=>{const S=R.target;S.style.display="none";const C=document.createElement("i"),x=c||D.COINS;C.className=`${x} crypto-icon ${a}`,S.parentElement?.appendChild(C)}});const N=c||D.COINS,T=u?.toLowerCase()||"default";return f(N,{className:`crypto-icon ${T} ${w} ${a}`})}}class Q extends p{oninit(t){super.oninit(t),this.state={showDropdown:!1}}view(){const{selectedPlatform:t}=this.attrs,{showDropdown:e}=this.state;return m("div",{className:"WithdrawalPage-platformSelector"},m("div",{className:"WithdrawalPage-label"},"提取平台"),m("div",{className:"WithdrawalPage-platformDropdown",onclick:()=>this.toggleDropdown()},m("div",{className:"WithdrawalPage-platformSelected"},m("div",{className:"WithdrawalPage-platformInfo"},m("div",{className:"WithdrawalPage-platformIcon"},m(U,{platform:t,size:"medium"})),m("div",{className:"WithdrawalPage-platformDetails"},m("div",{className:"WithdrawalPage-platformName"},this.getPlatformName(t))))),f(D.CHEVRON_DOWN,{className:"WithdrawalPage-dropdownIcon"})),e&&this.renderPlatformDropdown())}toggleDropdown(){this.state.showDropdown=!this.state.showDropdown}getPlatformName(t){return t&&(n(t,"displayName")||n(t,"name"))||"请选择平台"}renderPlatformDropdown(){const{platforms:t}=this.attrs,e=(t||[]).filter(a=>!!a);return e.length===0?m("div",{className:"WithdrawalPage-dropdownMenu"},m("div",{className:"WithdrawalPage-dropdownItem WithdrawalPage-noData"},s.translator.trans("withdrawal.forum.no_platforms"))):m("div",{className:"WithdrawalPage-dropdownMenu"},e.map(a=>m("div",{key:a.id(),className:"WithdrawalPage-dropdownItem",onclick:()=>this.selectPlatform(a)},m("div",{className:"WithdrawalPage-platformIcon"},m(U,{platform:a,size:"small"})),m("div",{className:"WithdrawalPage-platformName"},n(a,"displayName")||n(a,"name")))))}selectPlatform(t){const{onPlatformSelect:e,onAmountChange:a}=this.attrs;e(t),this.state.showDropdown=!1,a&&a()}}class Z extends p{view(){const{amount:t,selectedPlatform:e,loadingBalance:a,onAmountChange:i,onFillAllAmount:l}=this.attrs,c=this.getMinAmount(e),h=this.getMaxAmount(e),u=this.getFee(e);return m("div",{className:"WithdrawalPage-amountSection"},m("div",{className:"WithdrawalPage-formGroup"},m("div",{className:"WithdrawalPage-label"},s.translator.trans("withdrawal.forum.form.amount")),m("div",{className:"WithdrawalPage-amountInput"},m("input",{type:"text",className:"WithdrawalPage-input",placeholder:"0.00000000",value:t,oninput:w=>i(w.target.value)}),m(P,{className:"WithdrawalPage-allButton",onclick:l,disabled:a},s.translator.trans("withdrawal.forum.form.all_button"))),m("div",{className:"WithdrawalPage-amountLimits"},m("div",{className:"WithdrawalPage-limitRow"},m("span",{className:"WithdrawalPage-limitLabel"},s.translator.trans("withdrawal.forum.limits.min_max")),m("span",{className:"WithdrawalPage-limitValue"},f(D.COINS)," ",c," ~ ",h)),m("div",{className:"WithdrawalPage-limitRow"},m("span",{className:"WithdrawalPage-limitLabel"},s.translator.trans("withdrawal.forum.limits.fee")),m("span",{className:"WithdrawalPage-limitValue"},f(D.COINS)," ",u)))))}getMinAmount(t){return t&&n(t,"minAmount")||y.MIN_AMOUNT}getMaxAmount(t){return t&&n(t,"maxAmount")||y.MAX_AMOUNT}getFee(t){return t&&n(t,"fee")||y.FEE}}class $ extends p{view(){const{accountDetails:t,selectedPlatform:e,saveAddress:a,onAccountDetailsChange:i,onSaveAddressToggle:l}=this.attrs,c=this.getSymbol(e);return o("div",{className:"WithdrawalPage-addressSection"},o("div",{className:"WithdrawalPage-formGroup"},o("div",{className:"WithdrawalPage-addressHeader"},o("span",{className:"WithdrawalPage-label"},s.translator.trans("withdrawal.forum.form.address",{symbol:c}),o("span",{className:"WithdrawalPage-required"},"*")),o("div",{className:"WithdrawalPage-saveAddress",onclick:()=>l(!a)},f(D.BOOKMARK),s.translator.trans("withdrawal.forum.form.save_address"))),o("div",{className:"WithdrawalPage-addressInput"},o("input",{type:"text",className:"WithdrawalPage-input",placeholder:s.translator.trans("withdrawal.forum.form.address_placeholder"),value:t,oninput:h=>i(h.target.value)}),o("button",{className:"WithdrawalPage-pasteButton",onclick:()=>this.pasteFromClipboard()},f(D.PASTE)))))}getSymbol(t){return t&&n(t,"symbol")||""}async pasteFromClipboard(){const{onAccountDetailsChange:t}=this.attrs;try{if(navigator.clipboard&&navigator.clipboard.readText){const e=await navigator.clipboard.readText();t(e.trim()),o.redraw()}}catch(e){console.error("Failed to read from clipboard:",e),s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.clipboard_error"))}}}class M extends p{view(){const{message:t,onMessageChange:e}=this.attrs;return m("div",{className:"WithdrawalPage-messageSection"},m("div",{className:"WithdrawalPage-formGroup"},m("span",{className:"WithdrawalPage-label"},s.translator.trans("withdrawal.forum.form.message")),m("textarea",{className:"WithdrawalPage-textarea",placeholder:s.translator.trans("withdrawal.forum.form.message_placeholder"),value:t,rows:3,maxlength:500,oninput:a=>e(a.target.value)}),m("div",{className:"WithdrawalPage-helperText"},s.translator.trans("withdrawal.forum.form.message_helper")," (",t.length,"/500)")))}}class tt extends p{view(){const{amount:t,selectedPlatform:e,submitting:a,canSubmit:i,onSubmit:l}=this.attrs,c=parseFloat(t)||0,h=this.getFee(e),u=Math.max(0,c-h),w=this.getSymbol(e);return m("div",{className:"WithdrawalPage-submitSection"},m(P,{className:"WithdrawalPage-submitButton",loading:a,disabled:!i,onclick:l},s.translator.trans("withdrawal.forum.form.submit")),c>0&&m("div",{className:"WithdrawalPage-finalAmount"},s.translator.trans("withdrawal.forum.final_amount",{amount:u.toFixed(y.BALANCE_PRECISION),symbol:w})))}getFee(t){return t&&n(t,"fee")||y.FEE}getSymbol(t){return t&&n(t,"symbol")||""}}class et extends p{view(){const{platforms:t,formData:e,loadingBalance:a,submitting:i,onFormDataChange:l,onFillAllAmount:c,onSubmit:h}=this.attrs;return[m(Q,{platforms:t,selectedPlatform:e.selectedPlatform,onPlatformSelect:u=>l({selectedPlatform:u}),onAmountChange:()=>l({amount:""})}),m(Z,{amount:e.amount,selectedPlatform:e.selectedPlatform,loadingBalance:a,onAmountChange:u=>l({amount:u}),onFillAllAmount:c}),m($,{accountDetails:e.accountDetails,selectedPlatform:e.selectedPlatform,saveAddress:e.saveAddress,onAccountDetailsChange:u=>l({accountDetails:u}),onSaveAddressToggle:u=>l({saveAddress:u})}),m(M,{message:e.message,onMessageChange:u=>l({message:u})}),m(tt,{amount:e.amount,selectedPlatform:e.selectedPlatform,accountDetails:e.accountDetails,submitting:i,canSubmit:this.canSubmit(),onSubmit:h})]}canSubmit(){const{formData:t,submitting:e}=this.attrs,{selectedPlatform:a,amount:i,accountDetails:l}=t;return!!(a&&i&&l&&!e&&parseFloat(i)>0)}}class st extends p{view(){const{status:t,className:e=""}=this.attrs,a=this.getStatusClass(t),i=this.getStatusLabel(t);return m("div",{className:`WithdrawalPage-historyStatus ${a} ${e}`},i)}getStatusClass(t){return V[t]||V.pending}getStatusLabel(t){return s.translator.trans(`withdrawal.forum.status.${t}`).toString()}}class at extends p{view(){const{iconName:t,title:e,description:a,className:i=""}=this.attrs;return m("div",{className:`WithdrawalPage-emptyState ${i}`},m("div",{className:"WithdrawalPage-emptyIcon"},f(t)),m("h3",{className:"WithdrawalPage-emptyTitle"},e),m("p",{className:"WithdrawalPage-emptyDescription"},a))}}function rt(d){const{className:t=""}=d;return m("div",{className:`WithdrawalPage-loading ${t}`},m(q,null))}class G extends p{view(t){const{transactions:e,platforms:a,loading:i,type:l}=t.attrs;return i?m(rt,{className:`${l}History-loading`}):!e||e.length===0?m(at,{iconName:l==="withdrawal"?"fas fa-history":"fas fa-inbox",title:s.translator.trans(`${l}.forum.history.empty.title`),description:s.translator.trans(`${l}.forum.history.empty.description`),className:`${l}History-empty`}):m("div",{className:`${l}History`},m("div",{className:`${l}History-header`},m("h3",null,s.translator.trans(`${l}.forum.history.title`)),m("span",{className:`${l}History-count`},e.length," ",s.translator.trans(`${l}.forum.history.transactions`))),m("div",{className:`${l}History-list`},e.map(c=>this.renderTransaction(c,a,l))))}renderTransaction(t,e,a){const i=this.getTransactionId(t),l=this.getPlatform(t,e),c=n(t,"amount")||0,h=n(t,"status")||"pending",u=n(t,"statusColor")||this.getStatusColor(h),w=I(t,"createdAt");return a==="deposit"?n(t,"platformAccount")?this.renderDepositRecord(t,l,c,h,u,w,i):this.renderDepositTransaction(t,l,c,h,u,w,i):this.renderWithdrawalTransaction(t,l,c,h,w,i)}renderWithdrawalTransaction(t,e,a,i,l,c){const h=n(t,"accountDetails")||"";return m("div",{key:c,className:"WithdrawalPage-historyItem"},m("div",{className:"WithdrawalPage-historyHeader"},m("div",{className:"WithdrawalPage-historyPlatform"},m("div",{className:"WithdrawalPage-platformIcon"},m(U,{platform:e,size:"small"})),m("div",{className:"WithdrawalPage-historyInfo"},m("div",{className:"WithdrawalPage-historyPlatformName"},this.getPlatformName(e)),m("div",{className:"WithdrawalPage-historyDate"},l.toLocaleDateString()," ",l.toLocaleTimeString()))),m(st,{status:i})),m("div",{className:"WithdrawalPage-historyDetails"},m("div",{className:"WithdrawalPage-historyAmount"},m("span",{className:"WithdrawalPage-historyLabel"},s.translator.trans("withdrawal.forum.history.amount"),":"),m("span",{className:"WithdrawalPage-historyValue"},a," ",this.getPlatformSymbol(e))),m("div",{className:"WithdrawalPage-historyAddress"},m("span",{className:"WithdrawalPage-historyLabel"},s.translator.trans("withdrawal.forum.history.address"),":"),m("span",{className:"WithdrawalPage-historyValue"},h))))}renderDepositRecord(t,e,a,i,l,c,h){const u=n(t,"platformAccount"),w=n(t,"realName"),N=I(t,"depositTime"),T=n(t,"screenshotUrl"),R=n(t,"userMessage"),S=I(t,"processedAt"),C=n(t,"adminNotes"),x=n(t,"creditedAmount");return m("div",{key:h,className:"DepositRecord-item"},m("div",{className:"DepositRecord-itemHeader"},m("div",{className:"DepositRecord-itemPlatform"},e&&m("[",null,m("div",{className:"DepositRecord-itemIcon"},this.renderPlatformIcon(e)),m("div",{className:"DepositRecord-itemInfo"},m("span",{className:"DepositRecord-itemCurrency"},n(e,"symbol")," ",n(e,"network")&&`(${n(e,"network")})`),m("span",{className:"DepositRecord-itemType"},"Manual Deposit")))),m("div",{className:"DepositRecord-itemAmount"},m("span",{className:"DepositRecord-itemAmountValue"},"+",a," ",e?n(e,"symbol"):""),m("div",{className:`DepositRecord-itemStatus status-${l}`},this.getStatusIcon(i),this.getStatusText(i)))),m("div",{className:"DepositRecord-itemDetails"},m("div",{className:"DepositRecord-itemMeta"},m("span",{className:"DepositRecord-itemTime"},"Submitted: ",c?W(c):"Unknown time"),N&&m("span",{className:"DepositRecord-itemDepositTime"},"Deposit Time: ",N.toLocaleDateString()," ",N.toLocaleTimeString())),m("div",{className:"DepositRecord-itemInfo"},m("div",{className:"DepositRecord-itemRow"},m("span",{className:"DepositRecord-itemLabel"},"Platform Account:"),m("span",{className:"DepositRecord-itemValue"},u)),w&&m("div",{className:"DepositRecord-itemRow"},m("span",{className:"DepositRecord-itemLabel"},"Real Name:"),m("span",{className:"DepositRecord-itemValue"},w)),R&&m("div",{className:"DepositRecord-itemRow"},m("span",{className:"DepositRecord-itemLabel"},"Message:"),m("span",{className:"DepositRecord-itemValue"},R)),T&&m("div",{className:"DepositRecord-itemRow"},m("span",{className:"DepositRecord-itemLabel"},"Screenshot:"),m("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:"DepositRecord-itemLink"},"View Screenshot ",f("fas fa-external-link-alt")))),S&&m("div",{className:"DepositRecord-itemProcessed"},m("div",{className:"DepositRecord-itemProcessedTime"},"Processed: ",W(S)),x&&x!==a&&m("div",{className:"DepositRecord-itemCredited"},"Credited Amount: ",x," ",e?n(e,"symbol"):""),C&&m("div",{className:"DepositRecord-itemNotes"},m("span",{className:"DepositRecord-itemLabel"},"Admin Notes:"),m("span",{className:"DepositRecord-itemValue"},C)))))}renderDepositTransaction(t,e,a,i,l,c,h){const u=n(t,"transactionHash"),w=n(t,"explorerUrl"),N=n(t,"completedAt"),T=n(t,"confirmations")||0,R=n(t,"requiredConfirmations")||1;return m("div",{key:h,className:"DepositHistory-item"},m("div",{className:"DepositHistory-itemHeader"},m("div",{className:"DepositHistory-itemPlatform"},e&&m("[",null,m("div",{className:"DepositHistory-itemIcon"},this.renderPlatformIcon(e)),m("div",{className:"DepositHistory-itemInfo"},m("span",{className:"DepositHistory-itemCurrency"},n(e,"symbol")),m("span",{className:"DepositHistory-itemNetwork"},n(e,"network"))))),m("div",{className:"DepositHistory-itemAmount"},m("span",{className:"DepositHistory-itemAmountValue"},"+",a," ",e?n(e,"symbol"):""),m("div",{className:`DepositHistory-itemStatus status-${l}`},this.getStatusIcon(i),this.getStatusText(i)))),m("div",{className:"DepositHistory-itemDetails"},m("div",{className:"DepositHistory-itemMeta"},m("span",{className:"DepositHistory-itemTime"},c?W(c):"Unknown time"),i==="confirmed"||i==="completed"?m("span",{className:"DepositHistory-itemConfirmations"},T,"/",R," confirmations"):null),u&&m("div",{className:"DepositHistory-itemHash"},m("span",{className:"DepositHistory-itemHashLabel"},"Transaction:"),w?m("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"DepositHistory-itemHashLink"},this.formatHash(u),f("fas fa-external-link-alt")):m("span",{className:"DepositHistory-itemHashText"},this.formatHash(u))),N&&m("div",{className:"DepositHistory-itemCompleted"},m("span",null,"Credited: ",W(N)))))}getTransactionId(t){return typeof t.id=="function"?`transaction-${t.id()}`:`transaction-${_(t)||Math.random()}`}getPlatform(t,e){const a=this.getPlatformId(t);return Y(e,a)}getPlatformId(t){return n(t,"platformId")||t.relationships?.platform?.data?.id||""}getPlatformName(t){return t&&n(t,"name")||"Unknown Platform"}getPlatformSymbol(t){return t&&n(t,"symbol")||""}getStatusColor(t){switch(t){case"pending":return"warning";case"approved":case"confirmed":case"completed":return"success";case"rejected":case"failed":case"cancelled":return"danger";default:return"secondary"}}renderPlatformIcon(t){const e=n(t,"iconUrl"),a=n(t,"iconClass"),i=n(t,"symbol");if(e)return m("img",{src:e,alt:i,className:"DepositHistory-platformImg"});if(a)return f(a);switch(i){case"USDT":return m("span",{className:"DepositHistory-currencyIcon usdt"},"₮");case"USDC":return m("span",{className:"DepositHistory-currencyIcon usdc"},"$");case"BTC":return m("span",{className:"DepositHistory-currencyIcon btc"},"₿");case"ETH":return m("span",{className:"DepositHistory-currencyIcon eth"},"Ξ");default:return f("fas fa-coins")}}getStatusIcon(t){switch(t){case"pending":return f("fas fa-clock");case"approved":case"confirmed":return f("fas fa-check-circle");case"completed":return f("fas fa-check-double");case"rejected":case"failed":return f("fas fa-times-circle");case"cancelled":return f("fas fa-ban");default:return f("fas fa-question-circle")}}getStatusText(t){switch(t){case"pending":return"Pending";case"approved":return"Approved";case"confirmed":return"Confirmed";case"completed":return"Completed";case"rejected":return"Rejected";case"failed":return"Failed";case"cancelled":return"Cancelled";default:return"Unknown"}}formatHash(t){return t.length<=16?t:`${t.substring(0,8)}...${t.substring(t.length-8)}`}}class it extends p{constructor(){super(...arguments),this.handleOutsideClick=t=>{const e=this.element;e&&!e.contains(t.target)&&(this.state.showDropdown=!1,o.redraw())}}oninit(t){super.oninit(t),this.state={showDropdown:!1}}view(){const{selectedPlatform:t}=this.attrs,{showDropdown:e}=this.state;return o("div",{className:"FundsPage-platformSelector"},o("div",{className:"FundsPage-label"},s.translator.trans("withdrawal.forum.deposit.platform_label")),o("div",{className:"FundsPage-platformDropdown",onclick:()=>this.toggleDropdown()},o("div",{className:"FundsPage-platformSelected"},o("div",{className:"FundsPage-platformInfo"},o("div",{className:"FundsPage-platformIcon"},this.renderPlatformIcon(t)),o("div",{className:"FundsPage-platformDetails"},o("div",{className:"FundsPage-platformName"},this.getPlatformDisplayName(t)),t&&this.renderPlatformSubtext(t)))),f(D.CHEVRON_DOWN,{className:"FundsPage-dropdownIcon"})),e&&this.renderPlatformDropdown())}oncreate(t){super.oncreate(t),document.addEventListener("click",this.handleOutsideClick)}onremove(t){super.onremove(t),document.removeEventListener("click",this.handleOutsideClick)}toggleDropdown(){this.state.showDropdown=!this.state.showDropdown}getPlatformDisplayName(t){if(!t)return s.translator.trans("withdrawal.forum.deposit.select_platform").toString();const e=n(t,"name")||"",a=n(t,"network");return a?`${e} (${a})`:e}renderPlatformIcon(t){if(!t)return f("fas fa-coins");const e=n(t,"iconUrl"),a=n(t,"symbol");return e?o("img",{src:e,alt:a,className:"FundsPage-platformIconImage"}):this.getCurrencyIcon(a)}getCurrencyIcon(t){switch(t?.toUpperCase()){case"USDT":return o("span",{className:"FundsPage-currencyIcon usdt"},"₮");case"USDC":return o("span",{className:"FundsPage-currencyIcon usdc"},"$");case"BTC":return o("span",{className:"FundsPage-currencyIcon btc"},"₿");case"ETH":return o("span",{className:"FundsPage-currencyIcon eth"},"Ξ");default:return f("fas fa-coins")}}renderPlatformSubtext(t){const e=n(t,"minAmount"),a=n(t,"fee"),i=n(t,"symbol"),l=[];return e&&e>0&&l.push(s.translator.trans("withdrawal.forum.deposit.min_amount_short",{amount:e,symbol:i}).toString()),a&&a>0&&l.push(s.translator.trans("withdrawal.forum.deposit.fee_short",{fee:a,symbol:i}).toString()),l.length>0?o("div",{className:"FundsPage-platformSubtext"},l.join(" • ")):null}renderPlatformDropdown(){const{platforms:t}=this.attrs,e=this.groupPlatformsByCurrency(t);return Object.keys(e).length===0?o("div",{className:"FundsPage-dropdownMenu"},o("div",{className:"FundsPage-dropdownItem FundsPage-noData"},s.translator.trans("withdrawal.forum.deposit.no_platforms"))):o("div",{className:"FundsPage-dropdownMenu"},Object.entries(e).flatMap(([a,i])=>[o("div",{key:`${a}-header`,className:"FundsPage-dropdownHeader"},o("div",{className:"FundsPage-currencyHeader"},o("div",{className:"FundsPage-currencyIcon"},this.getCurrencyIcon(a)),o("span",{className:"FundsPage-currencyName"},a))),...i.map(l=>o("div",{key:l.id(),className:"FundsPage-dropdownItem",onclick:()=>this.selectPlatform(l)},o("div",{className:"FundsPage-platformIcon"},this.renderPlatformIcon(l)),o("div",{className:"FundsPage-platformInfo"},o("div",{className:"FundsPage-platformName"},this.getPlatformDisplayName(l)),this.renderPlatformSubtext(l))))]))}groupPlatformsByCurrency(t){const e={};return(t||[]).filter(i=>i&&n(i,"isActive")).forEach(i=>{const l=n(i,"symbol");e[l]||(e[l]=[]),e[l].push(i)}),Object.keys(e).forEach(i=>{e[i].sort((l,c)=>{const h=n(l,"network")||"",u=n(c,"network")||"";return h.localeCompare(u)})}),e}selectPlatform(t){const{onPlatformSelect:e}=this.attrs;e(t),this.state.showDropdown=!1}}class ot extends p{view(t){const{address:e,loading:a,onCopy:i}=t.attrs;return m("div",{className:"AddressDisplay"},a?m("div",{className:"AddressDisplay-loading"},m("i",{className:"fas fa-spinner fa-spin"}),m("span",null,"Generating address...")):e?m("div",{className:"AddressDisplay-content"},m("div",{className:"AddressDisplay-address",title:e},e),m("div",{className:"AddressDisplay-actions"},m("button",{className:"AddressDisplay-copyBtn",onclick:i,title:"Copy address"},f("fas fa-copy")))):m("div",{className:"AddressDisplay-placeholder"},m("span",null,"No address available")))}}class nt extends p{view(t){const{platform:e,loading:a,size:i=160}=t.attrs;return m("div",{className:"ImageDisplay",style:{width:`${i}px`,height:`${i}px`}},a?m("div",{className:"ImageDisplay-loading"},m("i",{className:"fas fa-spinner fa-spin"})):e&&e.qrCodeImageUrl()?m("img",{src:e.qrCodeImageUrl(),alt:`${e.name()} Image`,className:"ImageDisplay-image",onerror:"this.style.display='none'; this.nextElementSibling.style.display='block';"}):m("div",{className:"ImageDisplay-placeholder"},m("i",{className:"fas fa-image"}),m("div",null,"No Image")),m("div",{className:"ImageDisplay-error",style:{display:"none"}},m("i",{className:"fas fa-exclamation-triangle"}),m("div",null,"Image Load Failed")))}}class lt extends p{oninit(t){super.oninit(t);const e=new Date,a=new Date(e.getTime()-e.getTimezoneOffset()*6e4).toISOString().slice(0,16);this.state={platformAccount:g(""),realName:g(""),amount:g(""),depositTime:g(a),screenshotUrl:g(""),userMessage:g("")}}view(t){const{platform:e,submitting:a}=t.attrs,i=n(e,"minAmount")||0,l=n(e,"maxAmount"),c=n(e,"symbol")||"";return m("div",{className:"DepositRecordForm"},m("div",{className:"DepositRecordForm-header"},m("div",{className:"DepositRecordForm-title"},m("i",{className:"fas fa-plus-circle"}),s.translator.trans("withdrawal.forum.deposit.record.form_title")),m("div",{className:"DepositRecordForm-platformInfo"},s.translator.trans("withdrawal.forum.deposit.record.selected_platform",{platform:n(e,"name"),symbol:c}))),m("form",{onsubmit:this.handleSubmit.bind(this),className:"DepositRecordForm-form"},m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.platform_account"),m("span",{className:"DepositRecordForm-required"},"*")),m("input",{type:"text",className:"DepositRecordForm-input",placeholder:s.translator.trans("withdrawal.forum.deposit.record.platform_account_placeholder"),value:this.state.platformAccount(),oninput:v("value",this.state.platformAccount),required:!0,disabled:a}),m("div",{className:"DepositRecordForm-help"},s.translator.trans("withdrawal.forum.deposit.record.platform_account_help"))),m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.real_name"),m("span",{className:"DepositRecordForm-optional"},"(",s.translator.trans("withdrawal.forum.deposit.record.optional"),")")),m("input",{type:"text",className:"DepositRecordForm-input",placeholder:s.translator.trans("withdrawal.forum.deposit.record.real_name_placeholder"),value:this.state.realName(),oninput:v("value",this.state.realName),disabled:a})),m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.amount")," (",c,")",m("span",{className:"DepositRecordForm-required"},"*")),m("input",{type:"number",step:"0.01",min:i,max:l,className:"DepositRecordForm-input",placeholder:s.translator.trans("withdrawal.forum.deposit.record.amount_placeholder"),value:this.state.amount(),oninput:v("value",this.state.amount),required:!0,disabled:a}),m("div",{className:"DepositRecordForm-limits"},i>0&&m("span",{className:"DepositRecordForm-limit"},s.translator.trans("withdrawal.forum.deposit.record.min_amount",{amount:i,symbol:c})),l&&m("span",{className:"DepositRecordForm-limit"},s.translator.trans("withdrawal.forum.deposit.record.max_amount",{amount:l,symbol:c})))),m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.deposit_time"),m("span",{className:"DepositRecordForm-required"},"*")),m("input",{type:"datetime-local",className:"DepositRecordForm-input",value:this.state.depositTime(),oninput:v("value",this.state.depositTime),required:!0,disabled:a}),m("div",{className:"DepositRecordForm-help"},s.translator.trans("withdrawal.forum.deposit.record.deposit_time_help"))),m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.screenshot_url"),m("span",{className:"DepositRecordForm-optional"},"(",s.translator.trans("withdrawal.forum.deposit.record.optional"),")")),m("input",{type:"url",className:"DepositRecordForm-input",placeholder:s.translator.trans("withdrawal.forum.deposit.record.screenshot_url_placeholder"),value:this.state.screenshotUrl(),oninput:v("value",this.state.screenshotUrl),disabled:a}),m("div",{className:"DepositRecordForm-help"},s.translator.trans("withdrawal.forum.deposit.record.screenshot_url_help"))),m("div",{className:"DepositRecordForm-field"},m("label",{className:"DepositRecordForm-label"},s.translator.trans("withdrawal.forum.deposit.record.user_message"),m("span",{className:"DepositRecordForm-optional"},"(",s.translator.trans("withdrawal.forum.deposit.record.optional"),")")),m("textarea",{className:"DepositRecordForm-textarea",placeholder:s.translator.trans("withdrawal.forum.deposit.record.user_message_placeholder"),value:this.state.userMessage(),oninput:v("value",this.state.userMessage),rows:3,disabled:a})),m("div",{className:"DepositRecordForm-actions"},m(P,{type:"button",className:"Button Button--secondary DepositRecordForm-cancelButton",onclick:t.attrs.onCancel,disabled:a},s.translator.trans("withdrawal.forum.deposit.record.cancel")),m(P,{type:"submit",className:"Button Button--primary DepositRecordForm-submitButton",loading:a,disabled:a},s.translator.trans("withdrawal.forum.deposit.record.submit")))))}handleSubmit(t){t.preventDefault();const{platform:e,onSubmit:a}=this.attrs;if(!this.state.platformAccount()||!this.state.amount()||!this.state.depositTime()){s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.record.validation.required_fields"));return}const i=parseFloat(this.state.amount());if(isNaN(i)||i<=0){s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.record.validation.invalid_amount"));return}const l=n(e,"minAmount")||0,c=n(e,"maxAmount");if(i<l){s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.record.validation.amount_too_low",{amount:i,min:l,symbol:n(e,"symbol")}));return}if(c&&i>c){s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.record.validation.amount_too_high",{amount:i,max:c,symbol:n(e,"symbol")}));return}const h={platformId:parseInt(_(e)),platformAccount:this.state.platformAccount(),realName:this.state.realName()||void 0,amount:i,depositTime:new Date(this.state.depositTime()),screenshotUrl:this.state.screenshotUrl()||void 0,userMessage:this.state.userMessage()||void 0};a(h)}}function z(d,t="An error occurred"){if(!d)return t;if(d.response&&d.response.errors&&Array.isArray(d.response.errors)){const e=d.response.errors[0];if(e&&e.detail)return e.detail}if(d.responseText){if(d.responseText.includes("<b>Fatal error</b>")||d.responseText.includes("<!DOCTYPE"))return"Server error occurred. Please try again later.";try{const e=JSON.parse(d.responseText);if(e.errors&&Array.isArray(e.errors))return e.errors[0].detail||t}catch{return"Server error occurred. Please try again later."}}return t}function Dt(d){return d}class E extends K{constructor(){super(...arguments),this.state={withdrawalPlatforms:[],withdrawalRequests:[],userBalance:0,loadingBalance:!0,submitting:!1,depositPlatforms:[],depositTransactions:[],depositRecords:[],showDepositRecordForm:!1,submittingDepositRecord:!1,loading:!0,activeTab:g("withdrawal")},this.withdrawalFormData={amount:g(""),selectedPlatform:g(null),accountDetails:g(""),message:g(""),saveAddress:g(!1)},this.depositFormData={selectedPlatform:g(null),userMessage:g("")},this.depositAddressData={address:"",platform:null,loading:!1},this.availablePlatforms=[]}oninit(t){super.oninit(t);const a=new URLSearchParams(window.location.search).get("tab"),i=this.getTabFromPath();i?this.state.activeTab(i):a&&this.isValidTab(a)&&this.state.activeTab(a),this.updatePageTitle(),this.loadAllData()}getTabFromPath(){const t=window.location.pathname;return t.includes("/funds/withdrawal")?"withdrawal":t.includes("/funds/deposit")?"deposit":t.includes("/funds/withdrawal-history")?"withdrawal-history":t.includes("/funds/deposit-history")?"deposit-history":null}isValidTab(t){return["withdrawal","deposit","withdrawal-history","deposit-history"].includes(t)}updatePageTitle(){const t=this.state.activeTab();let e="withdrawal.forum.page.title";switch(t){case"withdrawal":case"withdrawal-history":e="withdrawal.forum.page.title";break;case"deposit":case"deposit-history":e="withdrawal.forum.deposit.page.title";break}const a=s.translator.trans(e);s.setTitle(typeof a=="string"?a:a.toString())}view(){return this.state.loading?o("div",{className:"FundsPage"},o("div",{className:"FundsPage-loading"},o(q,null))):o("div",{className:"FundsPage"},o("div",{className:"FundsPage-modal"},this.renderHeader(),o("div",{className:"FundsPage-content"},this.renderActiveTab())))}renderHeader(){const t=this.state.activeTab();return o("div",{className:"FundsPage-header"},o("div",{className:"FundsPage-tabs"},o("div",{className:`FundsPage-tab ${t==="withdrawal"?"active":""}`,onclick:()=>this.handleTabChange("withdrawal")},s.translator.trans("withdrawal.forum.tabs.withdrawal")),o("div",{className:`FundsPage-tab ${t==="deposit"?"active":""}`,onclick:()=>this.handleTabChange("deposit")},s.translator.trans("withdrawal.forum.deposit.tabs.deposit")),o("div",{className:`FundsPage-tab ${t==="withdrawal-history"?"active":""}`,onclick:()=>this.handleTabChange("withdrawal-history")},s.translator.trans("withdrawal.forum.tabs.history")),o("div",{className:`FundsPage-tab ${t==="deposit-history"?"active":""}`,onclick:()=>this.handleTabChange("deposit-history")},s.translator.trans("withdrawal.forum.deposit.tabs.history"))),o(P,{className:"FundsPage-close",icon:"fas fa-times",onclick:()=>s.history.back()}))}renderActiveTab(){switch(this.state.activeTab()){case"withdrawal":return this.renderWithdrawalTab();case"deposit":return this.renderDepositTab();case"withdrawal-history":return this.renderWithdrawalHistoryTab();case"deposit-history":return this.renderDepositHistoryTab();default:return this.renderWithdrawalTab()}}renderWithdrawalTab(){return(this.state.withdrawalPlatforms||[]).filter(e=>!!e).length===0?o("div",{className:"FundsPage-withdrawalTab"},o("div",{className:"WithdrawalPage-emptyState"},o("div",{className:"WithdrawalPage-emptyIcon"},f("fas fa-coins")),o("h3",{className:"WithdrawalPage-emptyTitle"},s.translator.trans("withdrawal.forum.no_platforms")),o("p",{className:"WithdrawalPage-emptyDescription"},s.translator.trans("withdrawal.forum.no_platforms_description")))):o("div",{className:"FundsPage-withdrawalTab"},o(et,{platforms:this.state.withdrawalPlatforms,formData:this.getWithdrawalFormDataForComponent(),loadingBalance:this.state.loadingBalance,submitting:this.state.submitting,onFormDataChange:this.handleWithdrawalFormDataChange.bind(this),onFillAllAmount:this.handleFillAllAmount.bind(this),onSubmit:this.handleWithdrawalSubmit.bind(this)}))}renderDepositTab(){return(this.state.depositPlatforms||[]).filter(e=>e&&n(e,"isActive")).length===0?o("div",{className:"FundsPage-emptyState"},o("div",{className:"FundsPage-emptyIcon"},f("fas fa-coins")),o("h3",{className:"FundsPage-emptyTitle"},s.translator.trans("withdrawal.forum.deposit.no_platforms")),o("p",{className:"FundsPage-emptyDescription"},s.translator.trans("withdrawal.forum.deposit.no_platforms_description"))):o("div",{className:"FundsPage-depositTab"},this.renderDepositSelectors(),this.renderDepositInfo())}renderDepositSelectors(){return o("div",{className:"FundsPage-selectors"},o(it,{platforms:this.availablePlatforms,selectedPlatform:this.depositFormData.selectedPlatform(),onPlatformSelect:t=>this.handlePlatformSelect(t)}))}renderDepositInfo(){const t=this.depositFormData.selectedPlatform();if(!t)return o("div",{className:"FundsPage-selectPrompt"},o("p",null,s.translator.trans("withdrawal.forum.deposit.select_platform")));const e=n(t,"minAmount")||0,a=n(t,"warningText")||s.translator.trans("withdrawal.forum.deposit.default_warning",{currency:n(t,"symbol"),network:n(t,"network"),minAmount:e});return o("div",{className:"FundsPage-depositInfo"},o("p",{className:"FundsPage-instructionText"},s.translator.trans("withdrawal.forum.deposit.scan_or_use_address")),o(ot,{address:this.depositAddressData.address,loading:this.depositAddressData.loading,onCopy:this.handleCopyAddress.bind(this)}),o("p",{className:"FundsPage-minAmountText"},s.translator.trans("withdrawal.forum.deposit.min_amount",{amount:e,currency:n(t,"symbol")})),(()=>{const i=n(t,"fee")||0;return i>0?o("p",{className:"FundsPage-feeText"},s.translator.trans("withdrawal.forum.deposit.fee",{fee:i,currency:n(t,"symbol")})):null})(),this.depositAddressData.platform&&this.depositAddressData.platform.qrCodeImageUrl&&this.depositAddressData.platform.qrCodeImageUrl()&&o("div",{className:"FundsPage-imageContainer"},o(nt,{platform:this.depositAddressData.platform,loading:this.depositAddressData.loading,size:160})),o("div",{className:"FundsPage-infoPanel"},o("i",{className:"fas fa-info-circle"}),o("span",null,a)),o("div",{className:"FundsPage-recordSection"},o("div",{className:"FundsPage-recordHeader"},o("h4",null,s.translator.trans("withdrawal.forum.deposit.record.section_title")),o(P,{className:"Button Button--primary FundsPage-recordButton",onclick:this.handleToggleDepositRecordForm.bind(this),disabled:this.state.submittingDepositRecord},this.state.showDepositRecordForm?s.translator.trans("withdrawal.forum.deposit.record.hide_form"):s.translator.trans("withdrawal.forum.deposit.record.show_form"))),this.state.showDepositRecordForm&&o(lt,{platform:t,onSubmit:this.handleDepositRecordSubmit.bind(this),onCancel:this.handleCancelDepositRecordForm.bind(this),submitting:this.state.submittingDepositRecord})))}renderWithdrawalHistoryTab(){return o("div",{className:"FundsPage-withdrawalTab"},o(G,{transactions:this.state.withdrawalRequests,platforms:this.state.withdrawalPlatforms,loading:!1,type:"withdrawal"}))}renderDepositHistoryTab(){const t=[...this.state.depositTransactions,...this.state.depositRecords];return t.sort((e,a)=>{const i=I(e,"createdAt")||new Date(0);return(I(a,"createdAt")||new Date(0)).getTime()-i.getTime()}),o(G,{transactions:t,platforms:this.state.depositPlatforms,loading:!1,type:"deposit"})}handleTabChange(t){this.state.activeTab(t),this.updatePageTitle();const e=new URL(window.location.href);e.searchParams.set("tab",t),window.history.replaceState({},"",e.toString())}getWithdrawalFormDataForComponent(){return{selectedPlatform:this.withdrawalFormData.selectedPlatform(),amount:this.withdrawalFormData.amount(),accountDetails:this.withdrawalFormData.accountDetails(),message:this.withdrawalFormData.message(),saveAddress:this.withdrawalFormData.saveAddress()}}handleWithdrawalFormDataChange(t){t.selectedPlatform!==void 0&&this.withdrawalFormData.selectedPlatform(t.selectedPlatform),t.amount!==void 0&&this.withdrawalFormData.amount(t.amount),t.accountDetails!==void 0&&this.withdrawalFormData.accountDetails(t.accountDetails),t.message!==void 0&&this.withdrawalFormData.message(t.message),t.saveAddress!==void 0&&this.withdrawalFormData.saveAddress(t.saveAddress)}async handleFillAllAmount(){const t=this.withdrawalFormData.selectedPlatform();if(t&&!this.state.loadingBalance)try{await this.loadUserBalance(!0);const e=n(t,"fee")||0,a=n(t,"maxAmount")||1/0;let i=this.state.userBalance-e;a<1/0&&i>a&&(i=a),i>0?this.withdrawalFormData.amount(i.toString()):s.alerts.show({type:"warning",dismissible:!0},s.translator.trans("withdrawal.forum.insufficient_balance"))}catch(e){console.error("Error refreshing balance:",e),s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.balance_refresh_error"))}}async handleWithdrawalSubmit(){if(this.state.submitting)return;const t=this.withdrawalFormData.selectedPlatform(),e=this.withdrawalFormData.amount(),a=this.withdrawalFormData.accountDetails();if(!t||!e||!a)return;const i=parseFloat(e);if(isNaN(i)||i<=0){s.alerts.show({type:"warning",dismissible:!0},s.translator.trans("withdrawal.forum.invalid_amount"));return}const l=n(t,"minAmount")||0,c=n(t,"maxAmount")||1/0;if(i<l){s.alerts.show({type:"warning",dismissible:!0},s.translator.trans("withdrawal.forum.amount_below_minimum",{amount:i,minimum:l,platform:n(t,"name")}));return}if(i>c){s.alerts.show({type:"warning",dismissible:!0},s.translator.trans("withdrawal.forum.amount_above_maximum",{amount:i,maximum:c,platform:n(t,"name")}));return}const h=n(t,"fee")||0,u=i+h;if(this.state.userBalance<u){const w=h>0?s.translator.trans("withdrawal.forum.including_fee",{fee:h}):"";s.alerts.show({type:"warning",dismissible:!0},s.translator.trans("withdrawal.forum.insufficient_balance_detailed",{required:u,available:this.state.userBalance,feeText:w}));return}this.state.submitting=!0;try{const w=await s.request({method:"POST",url:s.forum.attribute("apiUrl")+"/withdrawal-requests",body:{data:{type:"withdrawal-requests",attributes:{platformId:_(t),amount:parseFloat(e),accountDetails:a,message:this.withdrawalFormData.message(),saveAddress:this.withdrawalFormData.saveAddress()}}}});s.store.pushPayload(w),this.withdrawalFormData.amount(""),this.withdrawalFormData.accountDetails(""),this.withdrawalFormData.message(""),this.withdrawalFormData.saveAddress()||this.withdrawalFormData.selectedPlatform(null),this.loadUserBalance(),this.loadWithdrawalRequests(),s.alerts.show({type:"success",dismissible:!0},s.translator.trans("withdrawal.forum.submit_success"))}catch(w){console.error("Withdrawal request failed:",w);const N=z(w,s.translator.trans("withdrawal.forum.error").toString());s.alerts.show({type:"error",dismissible:!0},N)}finally{this.state.submitting=!1}}handlePlatformSelect(t){this.depositFormData.selectedPlatform(t),this.loadDepositAddress(t)}handleCopyAddress(){this.depositAddressData.address&&navigator.clipboard.writeText(this.depositAddressData.address).then(()=>{s.alerts.show({type:"success",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.address_copied"))}).catch(()=>{s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.copy_failed"))})}handleToggleDepositRecordForm(){this.state.showDepositRecordForm=!this.state.showDepositRecordForm,o.redraw()}handleCancelDepositRecordForm(){this.state.showDepositRecordForm=!1,o.redraw()}async handleDepositRecordSubmit(t){if(!this.state.submittingDepositRecord){this.state.submittingDepositRecord=!0,o.redraw();try{const e=await s.request({method:"POST",url:s.forum.attribute("apiUrl")+"/deposit-records",body:{data:{type:"deposit-records",attributes:{platformId:t.platformId,platformAccount:t.platformAccount,realName:t.realName,amount:t.amount,depositTime:t.depositTime.toISOString(),screenshotUrl:t.screenshotUrl,userMessage:t.userMessage}}}});s.store.pushPayload(e),this.state.showDepositRecordForm=!1,s.alerts.show({type:"success",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.record.submit_success")),this.loadDepositRecords()}catch(e){console.error("Deposit record submission failed:",e);const a=z(e,s.translator.trans("withdrawal.forum.deposit.record.submit_error").toString());s.alerts.show({type:"error",dismissible:!0},a)}finally{this.state.submittingDepositRecord=!1,o.redraw()}}}async loadAllData(){try{await Promise.all([this.loadWithdrawalData(),this.loadDepositData(),this.loadUserBalance()]),this.state.loading=!1,o.redraw()}catch(t){console.error("Error loading data:",t),this.state.loading=!1,o.redraw()}}async loadWithdrawalData(){const[t,e]=await Promise.all([s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/withdrawal-platforms"}),s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/withdrawal-requests"})]);s.store.pushPayload(t),s.store.pushPayload(e),this.state.withdrawalPlatforms=s.store.all("withdrawal-platforms"),this.state.withdrawalRequests=s.store.all("withdrawal-requests")}async loadDepositData(){const[t,e,a]=await Promise.all([s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/deposit-platforms"}),s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/deposit-transactions"}),s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/deposit-records"})]);s.store.pushPayload(t),s.store.pushPayload(e),s.store.pushPayload(a),this.state.depositPlatforms=s.store.all("deposit-platforms"),this.state.depositTransactions=s.store.all("deposit-transactions"),this.state.depositRecords=s.store.all("deposit-records"),this.availablePlatforms=this.state.depositPlatforms.filter(i=>n(i,"isActive"))}async loadDepositRecords(){try{const t=await s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/deposit-records"});s.store.pushPayload(t),this.state.depositRecords=s.store.all("deposit-records")}catch(t){console.error("Error loading deposit records:",t)}}async loadUserBalance(t=!1){try{if(this.state.loadingBalance=!0,t&&s.session.user){const e=s.session.user.id();if(!e)throw new Error("User ID not available");const a=await s.request({method:"GET",url:`${s.forum.attribute("apiUrl")}/users/${e}`});s.store.pushPayload(a);const i=s.store.getById("users",e);i?this.state.userBalance=parseFloat(i.attribute("money"))||0:this.state.userBalance=0}else this.state.userBalance=parseFloat(s.session.user?.attribute("money")||"0");this.state.loadingBalance=!1,o.redraw()}catch(e){console.error("Error loading user balance:",e),this.state.loadingBalance=!1,o.redraw()}}async loadWithdrawalRequests(){try{const t=await s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/withdrawal-requests"});s.store.pushPayload(t),this.state.withdrawalRequests=s.store.all("withdrawal-requests")}catch(t){console.error("Error loading withdrawal requests:",t)}}async loadDepositAddress(t){this.depositAddressData.loading=!0,o.redraw();try{const a=(await s.request({method:"GET",url:s.forum.attribute("apiUrl")+"/deposit-address",params:{platform_id:n(t,"id")}})).data;this.depositAddressData={address:a.attributes.address,addressTag:a.attributes.addressTag,platform:t,loading:!1},o.redraw()}catch(e){console.error("Error loading deposit address:",e),this.depositAddressData.loading=!1,s.alerts.show({type:"error",dismissible:!0},s.translator.trans("withdrawal.forum.deposit.address_load_error")),o.redraw()}}}class dt extends r{constructor(){super(...arguments),this.name=r.attribute("name"),this.symbol=r.attribute("symbol"),this.network=r.attribute("network"),this.displayName=r.attribute("displayName"),this.minAmount=r.attribute("minAmount"),this.maxAmount=r.attribute("maxAmount"),this.fee=r.attribute("fee"),this.iconUrl=r.attribute("iconUrl"),this.iconClass=r.attribute("iconClass"),this.isActive=r.attribute("isActive"),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate)}apiEndpoint(){return`/withdrawal-platforms/${this.id()}`}getDisplayName(){return this.displayName()||this.name()}isValidAmount(t){const e=this.minAmount(),a=this.maxAmount();return t>=e&&t<=a}getTotalCost(t){return t+this.fee()}}const A={PENDING:"pending",APPROVED:"approved",REJECTED:"rejected"};class mt extends r{constructor(){super(...arguments),this.amount=r.attribute("amount"),this.accountDetails=r.attribute("accountDetails"),this.message=r.attribute("message"),this.status=r.attribute("status"),this.platformId=r.attribute("platformId"),this.userId=r.attribute("userId"),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate),this.user=r.hasOne("user"),this.platform=r.hasOne("platform")}apiEndpoint(){return`/withdrawal-requests/${this.id()}`}isPending(){return this.status()===A.PENDING}isApproved(){return this.status()===A.APPROVED}isRejected(){return this.status()===A.REJECTED}canBeModified(){return this.isPending()}statusLabel(){const t=this.status();return X.translator.trans(`withdrawal.forum.status.${t}`).toString()}statusColor(){switch(this.status()){case A.APPROVED:return"success";case A.REJECTED:return"danger";case A.PENDING:default:return"warning"}}}class ct extends r{constructor(){super(...arguments),this.name=r.attribute("name"),this.symbol=r.attribute("symbol"),this.network=r.attribute("network"),this.networkTypeId=r.attribute("networkTypeId"),this.displayName=r.attribute("displayName"),this.minAmount=r.attribute("minAmount"),this.maxAmount=r.attribute("maxAmount"),this.fee=r.attribute("fee"),this.address=r.attribute("address"),this.qrCodeImageUrl=r.attribute("qrCodeImageUrl"),this.iconUrl=r.attribute("iconUrl"),this.iconClass=r.attribute("iconClass"),this.warningText=r.attribute("warningText"),this.networkConfig=r.attribute("networkConfig"),this.isActive=r.attribute("isActive"),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate)}}class ut extends r{constructor(){super(...arguments),this.address=r.attribute("address"),this.addressTag=r.attribute("addressTag"),this.fullAddress=r.attribute("fullAddress"),this.isActive=r.attribute("isActive"),this.lastUsedAt=r.attribute("lastUsedAt",r.transformDate),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate),this.user=r.hasOne("user"),this.platform=r.hasOne("platform")}}class ht extends r{constructor(){super(...arguments),this.amount=r.attribute("amount"),this.fee=r.attribute("fee"),this.creditedAmount=r.attribute("creditedAmount"),this.transactionHash=r.attribute("transactionHash"),this.fromAddress=r.attribute("fromAddress"),this.memo=r.attribute("memo"),this.userMessage=r.attribute("userMessage"),this.status=r.attribute("status"),this.statusColor=r.attribute("statusColor"),this.blockchainData=r.attribute("blockchainData"),this.confirmations=r.attribute("confirmations"),this.requiredConfirmations=r.attribute("requiredConfirmations"),this.hasEnoughConfirmations=r.attribute("hasEnoughConfirmations"),this.canBeCompleted=r.attribute("canBeCompleted"),this.explorerUrl=r.attribute("explorerUrl"),this.detectedAt=r.attribute("detectedAt",r.transformDate),this.confirmedAt=r.attribute("confirmedAt",r.transformDate),this.completedAt=r.attribute("completedAt",r.transformDate),this.adminNotes=r.attribute("adminNotes"),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate),this.user=r.hasOne("user"),this.platform=r.hasOne("platform"),this.depositAddress=r.hasOne("depositAddress"),this.processedBy=r.hasOne("processedBy")}}const b=class b extends r{constructor(){super(...arguments),this.id=r.attribute("id"),this.userId=r.attribute("userId"),this.platformId=r.attribute("platformId"),this.platformAccount=r.attribute("platformAccount"),this.realName=r.attribute("realName"),this.amount=r.attribute("amount"),this.depositTime=r.attribute("depositTime",r.transformDate),this.screenshotUrl=r.attribute("screenshotUrl"),this.userMessage=r.attribute("userMessage"),this.status=r.attribute("status"),this.processedAt=r.attribute("processedAt",r.transformDate),this.processedBy=r.attribute("processedBy"),this.adminNotes=r.attribute("adminNotes"),this.creditedAmount=r.attribute("creditedAmount"),this.createdAt=r.attribute("createdAt",r.transformDate),this.updatedAt=r.attribute("updatedAt",r.transformDate),this.user=r.hasOne("user"),this.platform=r.hasOne("platform"),this.processedByUser=r.hasOne("processedByUser")}isPending(){return this.status()===b.STATUS_PENDING}isApproved(){return this.status()===b.STATUS_APPROVED}isRejected(){return this.status()===b.STATUS_REJECTED}getStatusColor(){switch(this.status()){case b.STATUS_PENDING:return"warning";case b.STATUS_APPROVED:return"success";case b.STATUS_REJECTED:return"error";default:return"secondary"}}};b.STATUS_PENDING="pending",b.STATUS_APPROVED="approved",b.STATUS_REJECTED="rejected";let k=b;class ft extends p{view(){if(!s.session.user)return null;const e=(s.forum.attribute("antoinefr-money.moneyname")||"[money]").replace("[money]",s.session.user.attribute("money")),a=s.forum.attribute("wusong8899-withdrawal.moneyIconUrl");return m("div",{id:"moneyDisplayContainer",className:"client1-header-adv-wrapper clientCustomizeWithdrawalHeaderTotalMoney"},m("div",{className:"clientCustomizeWithdrawalHeaderText"},a&&a.trim()&&m("span",{style:{borderRadius:"50%",padding:"6px 8px",marginRight:"8px",display:"inline-flex",alignItems:"center",justifyContent:"center"}},m("img",{src:a,alt:"Money icon",style:{width:"20px",height:"20px"},onError:i=>{const l=i.target;l.style.display="none"}})),e),m("div",{className:"clientCustomizeWithdrawalHeaderIcon"},m("i",{className:"fas fa-wallet"})),m("div",{className:"clientCustomizeWithdrawalButtons"},m("div",{className:"clientCustomizeWithdrawalButton",onclick:this.handleWithdrawalClick.bind(this),title:"提款"},m("i",{className:"fas fa-money-bill-transfer"}),m("span",{style:{marginLeft:"4px",fontSize:"12px"}},"提款")),m("div",{className:"clientCustomizeDepositButton",onclick:this.handleDepositClick.bind(this),title:"存款",style:{marginLeft:"8px"}},m("i",{className:"fas fa-coins"}),m("span",{style:{marginLeft:"4px",fontSize:"12px"}},"存款"))))}handleWithdrawalClick(t){t.preventDefault(),t.stopPropagation(),window.location.href="/funds?tab=withdrawal"}handleDepositClick(t){t.preventDefault(),t.stopPropagation(),window.location.href="/funds?tab=deposit"}}class wt extends p{view(){const t=s.session.user?.attribute("money")||0,e=s.forum.attribute("wusong8899-withdrawal.moneyIconUrl");return m("div",{className:"Navigation-mobileMoneyDisplay"},m("div",{className:"Navigation-moneySection",onclick:this.handleWithdrawalClick.bind(this),title:`余额: ${t} - 点击提款`},m("div",{className:"Navigation-moneyText"},e&&e.trim()&&m("span",{style:{borderRadius:"50%",padding:"4px 6px",marginRight:"6px",display:"inline-flex",alignItems:"center",justifyContent:"center"}},m("img",{src:e,alt:"Money icon",style:{width:"18px",height:"18px"},onError:a=>{const i=a.target;i.style.display="none"}})),m("span",{className:"Navigation-moneyAmount"},t)),m("div",{className:"Navigation-withdrawalButton"},m("i",{className:"fas fa-money-bill-transfer"}),m("span",null,"提款"))))}handleWithdrawalClick(t){t.preventDefault(),t.stopPropagation(),console.log("MobileMoneyDisplay clicked!");try{window.location.href="/funds?tab=withdrawal"}catch(e){console.error("Navigation error:",e),window.location.href="/funds?tab=withdrawal"}}}class F{constructor(){}static getInstance(){return F.instance||(F.instance=new F),F.instance}isTagsPage(){try{return s.current?.get("routeName")==="index"}catch{return!1}}}function H(){return window.innerWidth<=767}function B(){return window.innerWidth>=768&&window.innerWidth<=1024}function pt(){return window.innerWidth>1024}function gt(){return H()||B()}function bt(){return H()?"mobile":B()?"tablet":"desktop"}function Nt(){return"ontouchstart"in window||navigator.maxTouchPoints>0}const yt={isMobile:H,isTablet:B,isDesktop:pt,isMobileOrTablet:gt,getCurrentBreakpoint:bt,isTouchDevice:Nt};s.initializers.add("wusong8899-withdrawal",()=>{s.store.models["withdrawal-platforms"]=dt,s.store.models["withdrawal-requests"]=mt,s.store.models["deposit-platforms"]=ct,s.store.models["deposit-addresses"]=ut,s.store.models["deposit-transactions"]=ht,s.store.models["deposit-records"]=k,s.routes.funds={path:"/funds",component:E},s.routes.withdrawal={path:"/withdrawal",component:E},s.routes.deposit={path:"/deposit",component:E},O.extend(j.prototype,"view",function(d){const t=F.getInstance();s.session.user&&t.isTagsPage()&&!yt.isMobile()&&d.children.push(ft.component())}),O.extend(J.prototype,"view",function(d){if(window.innerWidth>768||s.current.get("routeName")!=="tags"||!s.session.user||!d||!d.children||!Array.isArray(d.children))return;d.children.some(a=>a&&a.attrs&&a.attrs.className&&a.attrs.className.includes("Navigation-mobileMoneyDisplay"))||d.children.push(wt.component({className:"item-withdrawal Navigation-mobileMoneyDisplay"}))})})})(flarum.core.compat["forum/app"],flarum.core.compat["common/extend"],flarum.core.compat["forum/components/HeaderPrimary"],flarum.core.compat["common/components/Navigation"],flarum.core.compat["common/components/Page"],flarum.core.compat["common/components/Button"],flarum.core.compat["common/components/LoadingIndicator"],flarum.core.compat["common/utils/Stream"],flarum.core.compat["common/helpers/icon"],m,flarum.core.compat["common/Component"],flarum.core.compat["common/helpers/humanTime"],flarum.core.compat["common/utils/withAttr"],flarum.core.compat["common/Model"],flarum.core.compat["common/app"]);
//# sourceMappingURL=forum.js.map

module.exports={};