{"version":3,"file":"forum.js","sources":["../src/forum/components/WithdrawalPage.tsx","../src/common/models/WithdrawalPlatform.ts","../src/common/models/WithdrawalRequest.ts","../src/common/extend.ts","../src/forum/index.ts"],"sourcesContent":["import app from 'flarum/forum/app';\r\nimport Page from 'flarum/common/components/Page';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport type Mithril from 'mithril';\r\n\r\ninterface WithdrawalPlatform {\r\n  id: number;\r\n  attributes: {\r\n    name: string;\r\n    symbol: string;\r\n    minAmount: number;\r\n    maxAmount: number;\r\n    fee: number;\r\n    iconUrl?: string;\r\n    iconClass?: string;\r\n  };\r\n}\r\n\r\ninterface WithdrawalRequest {\r\n  id: number;\r\n  attributes: {\r\n    amount: number;\r\n    accountDetails: string;\r\n    status: string;\r\n    createdAt: string;\r\n  };\r\n  relationships: {\r\n    platform: {\r\n      data: { id: number };\r\n    };\r\n  };\r\n}\r\n\r\nexport default class WithdrawalPage extends Page {\r\n  private platforms: WithdrawalPlatform[] = [];\r\n  private requests: WithdrawalRequest[] = [];\r\n  private loading = true;\r\n  private submitting = false;\r\n  private loadingBalance = true;\r\n  private userBalance = 0;\r\n  private showDropdown = false;\r\n\r\n  private amount = Stream('');\r\n  private selectedPlatform = Stream<WithdrawalPlatform | null>(null);\r\n  private accountDetails = Stream('');\r\n  private saveAddress = Stream(false);\r\n\r\n  oninit(vnode: Mithril.VnodeDOM) {\r\n    super.oninit(vnode);\r\n\r\n    app.setTitle(app.translator.trans('withdrawal.forum.page.title'));\r\n\r\n    this.loadData();\r\n    this.loadUserBalance();\r\n  }\r\n\r\n  view() {\r\n    if (this.loading) {\r\n      return (\r\n        <div className=\"WithdrawalPage\">\r\n          <div className=\"WithdrawalPage-loading\">\r\n            <LoadingIndicator />\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Check if no platforms are available\r\n    // Accept any truthy platform object - this handles both Model instances and plain objects\r\n    const validPlatforms = (this.platforms || []).filter(platform => !!platform);\r\n\r\n    if (validPlatforms.length === 0) {\r\n      return (\r\n        <div className=\"WithdrawalPage\">\r\n          <div className=\"WithdrawalPage-modal\">\r\n            <div className=\"WithdrawalPage-header\">\r\n              <div className=\"WithdrawalPage-tabs\">\r\n                <div className=\"WithdrawalPage-tab active\">\r\n                  {app.translator.trans('withdrawal.forum.tabs.crypto')}\r\n                </div>\r\n              </div>\r\n              <button className=\"WithdrawalPage-close\" onclick={() => window.history.back()}>\r\n                {icon('fas fa-times')}\r\n              </button>\r\n            </div>\r\n            \r\n            <div className=\"WithdrawalPage-content\">\r\n              <div className=\"WithdrawalPage-emptyState\">\r\n                <div className=\"WithdrawalPage-emptyIcon\">\r\n                  {icon('fas fa-coins')}\r\n                </div>\r\n                <h3 className=\"WithdrawalPage-emptyTitle\">\r\n                  {app.translator.trans('withdrawal.forum.no_platforms')}\r\n                </h3>\r\n                <p className=\"WithdrawalPage-emptyDescription\">\r\n                  {app.translator.trans('withdrawal.forum.no_platforms_description')}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"WithdrawalPage\">\r\n        <div className=\"WithdrawalPage-modal\">\r\n          <div className=\"WithdrawalPage-header\">\r\n            <div className=\"WithdrawalPage-tabs\">\r\n              <div className=\"WithdrawalPage-tab active\">\r\n                {app.translator.trans('withdrawal.forum.tabs.crypto')}\r\n              </div>\r\n            </div>\r\n            <button className=\"WithdrawalPage-close\" onclick={() => window.history.back()}>\r\n              {icon('fas fa-times')}\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"WithdrawalPage-content\">\r\n            {this.renderCryptoTypeToggle()}\r\n            {this.renderPlatformSelector()}\r\n            {this.renderAmountSection()}\r\n            {this.renderAddressSection()}\r\n            {this.renderSubmitButton()}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderCryptoTypeToggle(): Mithril.Children {\r\n    return (\r\n      <div className=\"WithdrawalPage-typeToggle\">\r\n        <div className=\"WithdrawalPage-typeOption active\">\r\n          {app.translator.trans('withdrawal.forum.types.crypto')}\r\n        </div>\r\n        <div className=\"WithdrawalPage-typeOption\">\r\n          {app.translator.trans('withdrawal.forum.types.fiat')}\r\n          <span className=\"WithdrawalPage-infoIcon\">{icon('fas fa-info-circle')}</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderPlatformSelector(): Mithril.Children {\r\n    const selected = this.selectedPlatform();\r\n    \r\n    return (\r\n      <div className=\"WithdrawalPage-platformSelector\">\r\n        <div className=\"WithdrawalPage-platformDropdown\" onclick={() => this.showDropdown = !this.showDropdown}>\r\n          <div className=\"WithdrawalPage-platformSelected\">\r\n            <div className=\"WithdrawalPage-platformInfo\">\r\n              <div className=\"WithdrawalPage-platformIcon\">\r\n                {selected ? this.renderPlatformIcon(selected) : icon('fas fa-bitcoin', { className: 'default-icon' })}\r\n              </div>\r\n              <div className=\"WithdrawalPage-platformDetails\">\r\n                <div className=\"WithdrawalPage-platformSymbol\">\r\n                  {selected ? ((typeof selected.symbol === 'function' ? selected.symbol() : selected.attributes?.symbol) || 'N/A') : 'N/A'}\r\n                </div>\r\n                <div className=\"WithdrawalPage-platformFlow\">\r\n                  {app.translator.trans('withdrawal.forum.remaining_flow', { amount: '0.00000000' })}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"WithdrawalPage-platformName\">\r\n              {selected ? (typeof selected.name === 'function' ? selected.name() : selected.attributes?.name) : 'No Platform Selected'}\r\n            </div>\r\n          </div>\r\n          {icon('fas fa-chevron-down', { className: 'WithdrawalPage-dropdownIcon' })}\r\n        </div>\r\n\r\n        {this.showDropdown && this.renderPlatformDropdown()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderPlatformDropdown(): Mithril.Children {\r\n    // Ensure platforms array is valid and filter out invalid items\r\n    const validPlatforms = (this.platforms || []).filter(platform => !!platform);\r\n\r\n    if (validPlatforms.length === 0) {\r\n      return (\r\n        <div className=\"WithdrawalPage-dropdownMenu\">\r\n          <div className=\"WithdrawalPage-dropdownItem WithdrawalPage-noData\">\r\n            {app.translator.trans('withdrawal.forum.no_platforms')}\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    return (\r\n      <div className=\"WithdrawalPage-dropdownMenu\">\r\n        {validPlatforms.map(platform => (\r\n          <div \r\n            key={platform.id}\r\n            className=\"WithdrawalPage-dropdownItem\"\r\n            onclick={() => {\r\n              this.selectedPlatform(platform);\r\n              this.showDropdown = false;\r\n              this.amount(''); // Clear amount when switching platforms\r\n            }}\r\n          >\r\n            <div className=\"WithdrawalPage-platformIcon\">\r\n              {this.renderPlatformIcon(platform)}\r\n            </div>\r\n            <div className=\"WithdrawalPage-platformDetails\">\r\n              <div className=\"WithdrawalPage-platformSymbol\">\r\n                {(typeof platform.symbol === 'function' ? platform.symbol() : platform.attributes?.symbol) || 'N/A'}\r\n              </div>\r\n              <div className=\"WithdrawalPage-platformName\">\r\n                {typeof platform.name === 'function' ? platform.name() : platform.attributes?.name}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderPlatformIcon(platform: WithdrawalPlatform): Mithril.Children {\r\n    // Add null checks to prevent errors\r\n    if (!platform) {\r\n      return icon('fas fa-coins', { className: 'crypto-icon default' });\r\n    }\r\n\r\n    // Handle both Model instances and plain objects\r\n    const iconUrl = typeof platform.iconUrl === 'function' ? platform.iconUrl() : platform.attributes?.iconUrl;\r\n    const iconClass = typeof platform.iconClass === 'function' ? platform.iconClass() : platform.attributes?.iconClass;\r\n    const name = typeof platform.name === 'function' ? platform.name() : platform.attributes?.name;\r\n    const symbol = typeof platform.symbol === 'function' ? platform.symbol() : platform.attributes?.symbol;\r\n\r\n    // Priority: iconUrl > iconClass > default\r\n    if (iconUrl) {\r\n      return (\r\n        <img \r\n          src={iconUrl} \r\n          alt={name || 'Platform'}\r\n          className=\"platform-icon-image\"\r\n          onerror={(e) => {\r\n            // Fallback to iconClass or default icon if image fails to load\r\n            const target = e.target as HTMLImageElement;\r\n            target.style.display = 'none';\r\n            const fallbackIcon = document.createElement('i');\r\n            const fallbackIconClass = iconClass || 'fas fa-coins';\r\n            fallbackIcon.className = `${fallbackIconClass} crypto-icon`;\r\n            target.parentElement?.appendChild(fallbackIcon);\r\n          }}\r\n        />\r\n      );\r\n    }\r\n\r\n    // Use Font Awesome icon class if specified, otherwise default\r\n    const finalIconClass = iconClass || 'fas fa-coins';\r\n    const finalSymbol = symbol?.toLowerCase() || 'default';\r\n    return icon(finalIconClass, { className: `crypto-icon ${finalSymbol}` });\r\n  }\r\n\r\n  private renderAmountSection(): Mithril.Children {\r\n    const selected = this.selectedPlatform();\r\n    const minAmount = selected ? (typeof selected.minAmount === 'function' ? selected.minAmount() : selected.attributes?.minAmount) : 0.001;\r\n    const maxAmount = selected ? (typeof selected.maxAmount === 'function' ? selected.maxAmount() : selected.attributes?.maxAmount) : 10;\r\n    const fee = selected ? (typeof selected.fee === 'function' ? selected.fee() : selected.attributes?.fee) : 0.0005;\r\n\r\n    return (\r\n      <div className=\"WithdrawalPage-amountSection\">\r\n        <div className=\"WithdrawalPage-formGroup\">\r\n          <div className=\"WithdrawalPage-balanceHeader\">\r\n            <span className=\"WithdrawalPage-label\">\r\n              {app.translator.trans('withdrawal.forum.form.amount')}\r\n            </span>\r\n            <span className=\"WithdrawalPage-balance\">\r\n              {app.translator.trans('withdrawal.forum.available_balance', { \r\n                amount: this.loadingBalance ? '0.00000000' : this.userBalance.toFixed(8) \r\n              })}\r\n            </span>\r\n          </div>\r\n\r\n          <div className=\"WithdrawalPage-amountInput\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"WithdrawalPage-input\"\r\n              placeholder=\"0.00000000\"\r\n              value={this.amount()}\r\n              oninput={(e: Event) => this.amount((e.target as HTMLInputElement).value)}\r\n            />\r\n            <Button\r\n              className=\"WithdrawalPage-allButton\"\r\n              onclick={this.fillAllAmount.bind(this)}\r\n            >\r\n              {app.translator.trans('withdrawal.forum.form.all_button')}\r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"WithdrawalPage-amountLimits\">\r\n            <div className=\"WithdrawalPage-limitRow\">\r\n              <span className=\"WithdrawalPage-limitLabel\">\r\n                {app.translator.trans('withdrawal.forum.limits.min_max')}\r\n              </span>\r\n              <span className=\"WithdrawalPage-limitValue\">\r\n                {icon('fas fa-coins')} {minAmount} ~ {maxAmount}\r\n              </span>\r\n            </div>\r\n            <div className=\"WithdrawalPage-limitRow\">\r\n              <span className=\"WithdrawalPage-limitLabel\">\r\n                {app.translator.trans('withdrawal.forum.limits.fee')}\r\n              </span>\r\n              <span className=\"WithdrawalPage-limitValue\">\r\n                {icon('fas fa-coins')} {fee}\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderAddressSection(): Mithril.Children {\r\n    const selected = this.selectedPlatform();\r\n    const symbol = selected ? (typeof selected.symbol === 'function' ? selected.symbol() : selected.attributes?.symbol) : '';\r\n\r\n    return (\r\n      <div className=\"WithdrawalPage-addressSection\">\r\n        <div className=\"WithdrawalPage-formGroup\">\r\n          <div className=\"WithdrawalPage-addressHeader\">\r\n            <span className=\"WithdrawalPage-label\">\r\n              {app.translator.trans('withdrawal.forum.form.address', { symbol })}\r\n              <span className=\"WithdrawalPage-required\">*</span>\r\n            </span>\r\n            <div className=\"WithdrawalPage-saveAddress\" onclick={() => this.saveAddress(!this.saveAddress())}>\r\n              {icon('fas fa-bookmark')}\r\n              {app.translator.trans('withdrawal.forum.form.save_address')}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"WithdrawalPage-addressInput\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"WithdrawalPage-input\"\r\n              placeholder={app.translator.trans('withdrawal.forum.form.address_placeholder')}\r\n              value={this.accountDetails()}\r\n              oninput={(e: Event) => this.accountDetails((e.target as HTMLInputElement).value)}\r\n            />\r\n            <button className=\"WithdrawalPage-pasteButton\" onclick={this.pasteFromClipboard.bind(this)}>\r\n              {icon('fas fa-paste')}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private renderSubmitButton(): Mithril.Children {\r\n    const amount = parseFloat(this.amount()) || 0;\r\n    const selected = this.selectedPlatform();\r\n    const fee = selected ? (typeof selected.fee === 'function' ? selected.fee() : selected.attributes?.fee) : 0;\r\n    const finalAmount = Math.max(0, amount - fee);\r\n    const symbol = selected ? (typeof selected.symbol === 'function' ? selected.symbol() : selected.attributes?.symbol) : '';\r\n\r\n    return (\r\n      <div className=\"WithdrawalPage-submitSection\">\r\n        <Button\r\n          className=\"WithdrawalPage-submitButton\"\r\n          loading={this.submitting}\r\n          disabled={!this.canSubmit()}\r\n          onclick={this.submit.bind(this)}\r\n        >\r\n          {app.translator.trans('withdrawal.forum.form.submit')}\r\n        </Button>\r\n\r\n        {amount > 0 && (\r\n          <div className=\"WithdrawalPage-finalAmount\">\r\n            {app.translator.trans('withdrawal.forum.final_amount', { \r\n              amount: finalAmount.toFixed(8), \r\n              symbol \r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  private canSubmit(): boolean {\r\n    return !!(\r\n      this.selectedPlatform() &&\r\n      this.amount() &&\r\n      this.accountDetails() &&\r\n      !this.submitting &&\r\n      parseFloat(this.amount()) > 0\r\n    );\r\n  }\r\n\r\n  private fillAllAmount(): void {\r\n    if (this.loadingBalance) return;\r\n    this.amount(this.userBalance.toFixed(8));\r\n  }\r\n\r\n  private async pasteFromClipboard(): Promise<void> {\r\n    try {\r\n      if (navigator.clipboard && navigator.clipboard.readText) {\r\n        const text = await navigator.clipboard.readText();\r\n        this.accountDetails(text.trim());\r\n        m.redraw();\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to read from clipboard:', error);\r\n      app.alerts.show({\r\n        type: 'error',\r\n        dismissible: true\r\n      }, app.translator.trans('withdrawal.forum.clipboard_error'));\r\n    }\r\n  }\r\n\r\n\r\n  private async submit(): Promise<void> {\r\n    if (!this.canSubmit()) return;\r\n\r\n    this.submitting = true;\r\n\r\n    try {\r\n      const platform = this.selectedPlatform()!;\r\n      \r\n      const response = await app.request({\r\n        method: 'POST',\r\n        url: app.forum.attribute('apiUrl') + '/withdrawal-requests',\r\n        body: {\r\n          data: {\r\n            type: 'withdrawal-requests',\r\n            attributes: {\r\n              platformId: typeof platform.id === 'function' ? platform.id() : platform.id,\r\n              amount: parseFloat(this.amount()),\r\n              accountDetails: this.accountDetails()\r\n            }\r\n          }\r\n        }\r\n      });\r\n      \r\n      if (response && response.data) {\r\n        app.store.pushPayload(response);\r\n      }\r\n\r\n      app.alerts.show({\r\n        type: 'success',\r\n        dismissible: true\r\n      }, app.translator.trans('withdrawal.forum.form.success'));\r\n\r\n      // Reset form\r\n      this.amount('');\r\n      this.accountDetails('');\r\n      this.saveAddress(false);\r\n\r\n      // Reload data\r\n      this.loadRequests();\r\n    } catch (error) {\r\n      console.error('Error submitting withdrawal request:', error);\r\n      app.alerts.show({\r\n        type: 'error',\r\n        dismissible: true\r\n      }, app.translator.trans('withdrawal.forum.form.error'));\r\n    } finally {\r\n      this.submitting = false;\r\n      m.redraw();\r\n    }\r\n  }\r\n\r\n  private async loadData(): Promise<void> {\r\n    try {\r\n      await Promise.all([\r\n        this.loadPlatforms(),\r\n        this.loadRequests()\r\n      ]);\r\n    } catch (error) {\r\n      console.error('Error loading data:', error);\r\n    } finally {\r\n      this.loading = false;\r\n      m.redraw();\r\n    }\r\n  }\r\n\r\n  private async loadPlatforms(): Promise<void> {\r\n    try {\r\n      console.log('Loading withdrawal platforms...');\r\n      const response = await app.store.find('withdrawal-platforms');\r\n      console.log('Platform response:', response);\r\n      \r\n      this.platforms = Array.isArray(response) ? response.filter(p => p !== null) : (response ? [response] : []);\r\n      console.log('Processed platforms:', this.platforms);\r\n      \r\n      // Auto-select first platform if available\r\n      if (this.platforms.length > 0 && !this.selectedPlatform()) {\r\n        this.selectedPlatform(this.platforms[0]);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading platforms:', error);\r\n      this.platforms = [];\r\n    }\r\n  }\r\n\r\n  private async loadRequests(): Promise<void> {\r\n    try {\r\n      const response = await app.store.find('withdrawal-requests');\r\n      this.requests = Array.isArray(response) ? response.filter(r => r !== null) : (response ? [response] : []);\r\n    } catch (error) {\r\n      console.error('Error loading requests:', error);\r\n      this.requests = [];\r\n    }\r\n  }\r\n\r\n  private async loadUserBalance(): Promise<void> {\r\n    try {\r\n      // Integration with antoinefr/flarum-ext-money extension\r\n      this.userBalance = app.session.user?.attribute('money') || 0;\r\n      this.loadingBalance = false;\r\n      m.redraw();\r\n    } catch (error) {\r\n      console.error('Error loading user balance:', error);\r\n      this.loadingBalance = false;\r\n      m.redraw();\r\n    }\r\n  }\r\n}","import Model from 'flarum/common/Model';\r\n\r\nexport default class WithdrawalPlatform extends Model {\r\n  name = Model.attribute('name');\r\n  symbol = Model.attribute('symbol');\r\n  minAmount = Model.attribute('minAmount');\r\n  maxAmount = Model.attribute('maxAmount');\r\n  fee = Model.attribute('fee');\r\n  iconUrl = Model.attribute('iconUrl');\r\n  iconClass = Model.attribute('iconClass');\r\n  isActive = Model.attribute('isActive');\r\n  createdAt = Model.attribute('createdAt', Model.transformDate);\r\n  updatedAt = Model.attribute('updatedAt', Model.transformDate);\r\n}","import Model from 'flarum/common/Model';\r\n\r\nexport default class WithdrawalRequest extends Model {\r\n  amount = Model.attribute('amount');\r\n  accountDetails = Model.attribute('accountDetails');\r\n  status = Model.attribute('status');\r\n  platformId = Model.attribute('platformId');\r\n  userId = Model.attribute('userId');\r\n  createdAt = Model.attribute('createdAt', Model.transformDate);\r\n  updatedAt = Model.attribute('updatedAt', Model.transformDate);\r\n  \r\n  user = Model.hasOne('user');\r\n  platform = Model.hasOne('withdrawal-platforms');\r\n}","import Extend from 'flarum/common/extenders';\r\nimport WithdrawalPlatform from './models/WithdrawalPlatform';\r\nimport WithdrawalRequest from './models/WithdrawalRequest';\r\n\r\nexport default [\r\n  new Extend.Store()\r\n    .add('withdrawal-platforms', WithdrawalPlatform)\r\n    .add('withdrawal-requests', WithdrawalRequest),\r\n];","import app from 'flarum/forum/app';\r\nimport { extend } from 'flarum/common/extend';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport HeaderSecondary from 'flarum/forum/components/HeaderSecondary';\r\nimport WithdrawalPage from './components/WithdrawalPage';\r\nimport WithdrawalPlatform from '../common/models/WithdrawalPlatform';\r\nimport WithdrawalRequest from '../common/models/WithdrawalRequest';\r\n\r\napp.initializers.add('wusong8899-withdrawal', () => {\r\n  // Register models in store\r\n  app.store.models['withdrawal-platforms'] = WithdrawalPlatform;\r\n  app.store.models['withdrawal-requests'] = WithdrawalRequest;\r\n  \r\n  app.routes.withdrawal = { path: '/withdrawal', component: WithdrawalPage };\r\n\r\n  extend(HeaderSecondary.prototype, 'items', function (items: ItemList<any>) {\r\n    if (app.session.user) {\r\n      items.add(\r\n        'withdrawal',\r\n        LinkButton.component(\r\n          {\r\n            href: app.route('withdrawal'),\r\n            icon: 'fas fa-money-bill-transfer',\r\n          },\r\n          app.translator.trans('withdrawal.forum.header.withdrawal_button')\r\n        ),\r\n        10\r\n      );\r\n    }\r\n  });\r\n});\r\n\r\nexport { default as extend } from '../common/extend';"],"names":["WithdrawalPage","Page","Stream","vnode","app","LoadingIndicator","platform","icon","selected","validPlatforms","iconUrl","iconClass","name","symbol","e","target","fallbackIcon","fallbackIconClass","finalIconClass","finalSymbol","minAmount","maxAmount","fee","Button","amount","finalAmount","text","error","response","p","r","WithdrawalPlatform","Model","WithdrawalRequest","Extend","extend","HeaderSecondary","items","LinkButton"],"mappings":"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"}